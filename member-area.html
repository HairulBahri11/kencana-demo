<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Kencana Store — Member Area</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
         :root {
      --kencana-blue: #E84158;
      --accent: #2E3A67;
      --muted: #6b7280;
    }

        body {
            font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI",
                Roboto, "Helvetica Neue", Arial;
        }

        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(11, 43, 72, 0.06);
        }

        .nav-link {
            color: #111827;
        }

        /* CSS untuk Simulasi Halaman */
        .member-content-page {
            /* Semua halaman disembunyikan secara default */
            display: none;
        }

        .member-content-page.active {
            /* Halaman yang aktif ditampilkan */
            display: block;
        }

        /* Styling untuk link aktif di Sidebar */
        .sidebar-link.active {
            background-color: var(--kencana-blue) !important;
            color: white !important;
        }
    </style>
</head>

<body class="bg-gray-50">
    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-6 py-3 flex items-center justify-between">
            <div class="flex items-center gap-6">
                <a href="#" class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-full bg-[color:var(--accent)] flex items-center justify-center font-bold text-[color:var(--kencana-blue)]">
                        K
                    </div>
                    <span class="text-xl font-semibold text-[color:var(--kencana-blue)]">Kencana Store</span>
                </a>
                <nav class="hidden lg:flex items-center gap-4 text-sm">
                    <a class="nav-link px-3 py-2 hover:text-[color:var(--kencana-blue)]" href="index.html">Home</a>
                    <a class="nav-link px-3 py-2 hover:text-[color:var(--kencana-blue)] font-bold text-[color:var(--kencana-blue)]"
                        href="#member">Member Area</a>
                </nav>
            </div>
        </div>
    </header>
    <main class="py-12 bg-gray-50" id="member">
        <div class="max-w-7xl mx-auto px-6">
            <h1 class="text-3xl font-extrabold text-[color:var(--kencana-blue)] mb-8">
                Area Member
            </h1>

            <div class="flex flex-col lg:flex-row gap-8">
                <aside class="lg:w-1/4">
                    <nav class="card p-4">
                        <ul class="space-y-1" id="sidebar-menu">
                            <li>
                                <a href="#dashboard" data-page="dashboard"
                                    class="sidebar-link block px-3 py-2 text-sm font-medium rounded-lg text-gray-700 hover:bg-gray-100">
                                    <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                    </svg>
                                    Dashboard
                                </a>
                            </li>
                            <li>
                                <a href="#profile" data-page="profile"
                                    class="sidebar-link block px-3 py-2 text-sm font-medium rounded-lg text-gray-700 hover:bg-gray-100">
                                    <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                    Profil Saya
                                </a>
                            </li>
                            <li>
                                <a href="#poin" data-page="poin"
                                    class="sidebar-link block px-3 py-2 text-sm font-medium rounded-lg text-gray-700 hover:bg-gray-100">
                                    <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
                                    </svg>
                                    Poin & Tukar Hadiah (Redeem)
                                </a>
                            </li>
                            <li>
                                <a href="#orders" data-page="orders"
                                    class="sidebar-link block px-3 py-2 text-sm font-medium rounded-lg text-gray-700 hover:bg-gray-100">
                                    <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
                                    </svg>
                                    Riwayat Transaksi
                                </a>
                            </li>
                            <li>
                                <a href="#settings" data-page="settings"
                                    class="sidebar-link block px-3 py-2 text-sm font-medium rounded-lg text-gray-700 hover:bg-gray-100">
                                    <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37a1.724 1.724 0 002.572-1.065z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>
                                    Pengaturan Akun
                                </a>
                            </li>
                            <li>
                                <a href="#logout"
                                    class="block px-3 py-2 text-sm font-medium rounded-lg text-red-600 hover:bg-red-50 mt-4 border-t pt-4 border-gray-100">
                                    <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                    </svg>
                                    Keluar
                                </a>
                            </li>
                        </ul>
                    </nav>
                </aside>

                <div class="lg:w-3/4 space-y-8" id="member-content-container">

                    <div id="dashboard" class="member-content-page active space-y-8">
                        <div class="card p-6">
                            <div class="flex items-start gap-4">
                                <div id="user-initial"
                                    class="w-16 h-16 flex-shrink-0 bg-gray-200 rounded-full flex items-center justify-center text-xl font-bold text-gray-600 border-4 border-[color:var(--accent)]">
                                    AS
                                </div>
                                <div>
                                    <h2 class="text-2xl font-semibold text-gray-800">
                                        Selamat Datang Kembali, <strong id="user-name">Pengguna Kencana</strong>!
                                    </h2>
                                    <p class="text-gray-500 mt-1 text-sm">
                                        Ini adalah ringkasan cepat aktivitas akun Anda.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="card p-5 border-t-4 border-[color:var(--accent)]">
                                <p class="text-sm font-medium text-gray-500">Poin Loyalitas</p>
                                <p id="dash-points" class="text-3xl font-bold text-[color:var(--kencana-blue)] mt-1">1,250</p>
                                <p class="text-xs text-gray-400 mt-1">Dapat ditukar di menu Redeem</p>
                            </div>
                            <div class="card p-5 border-t-4 border-yellow-500">
                                <p class="text-sm font-medium text-gray-500">Pesanan Diproses</p>
                                <p class="text-3xl font-bold text-yellow-600 mt-1">1</p>
                                <p class="text-xs text-gray-400 mt-1">Menunggu pengiriman</p>
                            </div>
                            <div class="card p-5 border-t-4 border-green-500">
                                <p class="text-sm font-medium text-gray-500">Status Member</p>
                                <p id="dash-status" class="text-3xl font-bold text-green-600 mt-1">Platinum</p>
                                <p class="text-xs text-gray-400 mt-1">Level tertinggi</p>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-xl font-semibold text-[color:var(--kencana-blue)] border-b pb-2 mb-4">
                                Riwayat Transaksi Terakhir
                            </h3>
                            <ul id="latest-transactions-list" class="divide-y divide-gray-100">
                            </ul>
                            <div class="mt-4 text-right">
                                <a href="#orders" data-page="orders"
                                    class="sidebar-link text-sm font-medium text-[color:var(--kencana-blue)] hover:underline">
                                    Lihat Semua Transaksi &rarr;
                                </a>
                            </div>
                        </div>
                    </div>

                    <div id="profile" class="member-content-page">
                        <div class="card p-6 space-y-6">
                            <h2 class="text-2xl font-semibold text-[color:var(--kencana-blue)] border-b pb-2">Informasi Profil</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-y-4 gap-x-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-500">Nama Lengkap</label>
                                    <p id="profile-name" class="mt-1 text-gray-800 font-semibold">Ahmad Santoso</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-500">Email</label>
                                    <p class="mt-1 text-gray-800 font-semibold">ahmad.santo@mail.com</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-500">Nomor Telepon</label>
                                    <p class="mt-1 text-gray-800 font-semibold">0812-3456-7890</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-500">Alamat Utama</label>
                                    <p class="mt-1 text-gray-800 font-semibold">Jl. Kencana Indah No. 5, Jakarta Selatan</p>
                                </div>
                            </div>
                            <button
                                class="px-4 py-2 bg-[color:var(--accent)] text-[color:var(--kencana-blue)] font-semibold rounded-lg hover:bg-yellow-400 transition">
                                Edit Profil
                            </button>
                        </div>
                    </div>

                    <div id="poin" class="member-content-page">
                        <div class="card p-6 space-y-6">
                            <h2 class="text-2xl font-semibold text-[color:var(--kencana-blue)] border-b pb-2">Poin Loyalitas & Tukar Hadiah</h2>

                            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg border-2 border-[color:var(--accent)]">
                                <div>
                                    <p class="text-lg font-medium text-gray-600">Total Poin Anda</p>
                                    <p id="poin-total" class="text-5xl font-extrabold text-[color:var(--accent)] mt-1">1,250</p>
                                    <p id="poin-value-info" class="text-sm text-gray-500 mt-2">Setara dengan Rp 125.000</p>
                                </div>
                                <button
                                    class="px-6 py-3 bg-red-600 text-white font-bold rounded-lg shadow-lg hover:bg-red-700 transition"
                                    onclick="alert('Anda diarahkan ke Katalog Hadiah! Poin Anda: ' + document.getElementById('poin-total').textContent.replace(',', ''))">
                                    TUKAR SEKARANG
                                </button>
                            </div>

                            <div>
                                <h3 class="text-lg font-semibold text-gray-700 mb-2">Riwayat Poin</h3>
                                <ul class="space-y-2 text-sm text-gray-600" id="poin-history">
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div id="orders" class="member-content-page">
                        <div class="card p-6 space-y-6">
                            <h2 class="text-2xl font-semibold text-[color:var(--kencana-blue)] border-b pb-2">Daftar Riwayat Transaksi</h2>

                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            ID Transaksi</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Tanggal</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Total</th>
                                        <th
                                            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status</th>
                                        <th></th> </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200" id="transaction-table">
                                </tbody>
                            </table>

                        </div>
                    </div>

                    <div id="settings" class="member-content-page">
                        <div class="card p-6 space-y-6">
                            <h2 class="text-2xl font-semibold text-[color:var(--kencana-blue)] border-b pb-2">Pengaturan dan Keamanan</h2>
                            <p class="text-gray-600">Di halaman ini, Anda dapat mengubah kata sandi, mengelola notifikasi, dan menghapus akun.</p>
                            <div class="space-y-4">
                                <button
                                    class="w-full text-left px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition">Ubah Kata Sandi</button>
                                <button
                                    class="w-full text-left px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition">Pengaturan Notifikasi</button>
                                <button
                                    class="w-full text-left px-4 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition">Hapus Akun Permanen</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </main>

    <div id="transaction-detail-modal"
        class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg p-6 m-4">
            <div class="flex justify-between items-center border-b pb-3 mb-4">
                <h3 class="text-xl font-semibold text-[color:var(--kencana-blue)]">Detail Transaksi <span
                        id="modal-transaction-id"></span></h3>
                <button id="close-modal-btn" class="text-gray-500 hover:text-gray-700 text-2xl font-bold">&times;</button>
            </div>
            <div class="space-y-3">
                <p><strong>Tanggal:</strong> <span id="modal-transaction-date"></span></p>
                <p><strong>Total:</strong> <span id="modal-transaction-total"></span></p>
                <p><strong>Status:</strong> <span id="modal-transaction-status"
                        class="px-2 py-0.5 text-xs font-semibold rounded-full"></span></p>
                <h4 class="font-semibold text-gray-700 mt-4 pt-2 border-t">Item Transaksi:</h4>
                <ul id="modal-transaction-items" class="list-disc list-inside text-sm text-gray-700 space-y-1">
                    </ul>
            </div>
            <div class="mt-6 text-right">
                <button
                    class="px-4 py-2 bg-[color:var(--kencana-blue)] text-white font-semibold rounded-lg hover:bg-blue-800 transition"
                    onclick="alert('Membuka halaman bantuan terkait transaksi ini')">
                    Bantuan Transaksi
                </button>
            </div>
        </div>
    </div>


    <script>
        // Data Simulasi Pengguna
        const userData = {
            name: "Ahmad Santoso",
            email: "ahmad.santo@mail.com",
            phone: "0812-3456-7890",
            address: "Jl. Kencana Indah No. 5, Jakarta Selatan",
            points: 1250,
            status: "Platinum",
            // Riwayat Transaksi (untuk menu Orders) - Menambahkan detail item
            // transactions: [
            //     {
            //         id: 'KNC7901', date: '15 Okt 2025', total: 850000, status: 'Diproses', color: 'yellow',
            //         items: [
            //             { name: 'Kemeja Batik Pria', qty: 2, price: 250000 },
            //             { name: 'Celana Panjang Katun', qty: 1, price: 350000 }
            //         ]
            //     },
            //     {
            //         id: 'KNC7812', date: '14 Okt 2025', total: 5200000, status: 'Lunas', color: 'green',
            //         items: [
            //             { name: 'Laptop Gaming ROG', qty: 1, price: 15000000 },
            //             { name: 'Mouse Gaming RGB', qty: 1, price: 200000 }
            //         ]
            //     },
            //     {
            //         id: 'KNC7700', date: '01 Okt 2025', total: 1000000, status: 'Selesai', color: 'green',
            //         items: [
            //             { name: 'Smart TV 4K 50 Inch', qty: 1, price: 4000000 }
            //         ]
            //     },
            //     {
            //         id: 'KNC7655', date: '25 Sep 2025', total: 450000, status: 'Batal', color: 'red',
            //         items: [
            //             { name: 'Headphone Bluetooth', qty: 1, price: 450000 }
            //         ]
            //     },
            // ],
            // Riwayat Transaksi (Diubah menjadi produk material/peralatan bangunan)
            transactions: [
                { 
                    id: 'KNC7901', 
                    date: '15 Okt 2025', 
                    total: 3400000, // (2500000 + 900000)
                    status: 'Diproses', 
                    color: 'yellow',
                    items: [
                        { name: 'Semen Portland (50kg) - 50 Sak', qty: 50, price: 50000 }, // Total: 2.500.000
                        { name: 'Pipa PVC AW 4 Inch', qty: 15, price: 60000 } // Total: 900.000
                    ]
                },
                { 
                    id: 'KNC7812', 
                    date: '14 Okt 2025', 
                    total: 1720000, // (1500000 + 220000)
                    status: 'Lunas', 
                    color: 'green',
                    items: [
                        { name: 'Cat Tembok Eksterior (25L)', qty: 1, price: 1500000 },
                        { name: 'Kuas Rol Besar', qty: 4, price: 55000 } // Total: 220.000
                    ]
                },
                { 
                    id: 'KNC7700', 
                    date: '01 Okt 2025', 
                    total: 4000000, 
                    status: 'Selesai', 
                    color: 'green',
                    items: [
                        { name: 'Keramik Lantai 60x60 (Grade A)', qty: 40, price: 100000 } // Total: 4.000.000
                    ]
                },
                { 
                    id: 'KNC7655', 
                    date: '25 Sep 2025', 
                    total: 1125000, 
                    status: 'Batal', 
                    color: 'red',
                    items: [
                        { name: 'Bor Listrik Impact Heavy Duty', qty: 1, price: 750000 },
                        { name: 'Set Kunci Pas Lengkap', qty: 1, price: 375000 }
                    ]
                },
            ],
            // Riwayat Poin (untuk menu Poin)
            pointHistory: [
                { type: 'Kredit', amount: 52, desc: 'Poin dari Transaksi KNC7812', date: '14 Okt 2025' },
                { type: 'Debit', amount: 500, desc: 'Redeem Voucher Diskon Rp 50.000', date: '10 Okt 2025' },
                { type: 'Kredit', amount: 100, desc: 'Poin Bonus Ulang Tahun', date: '01 Okt 2025' },
            ],
        };

        // Fungsi untuk memformat angka menjadi format Rupiah (Contoh Sederhana)
        const formatRupiah = (number) => {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(number);
        };

        // --- FUNGSI GANTI HALAMAN ---
        function switchPage(pageId) {
            // Sembunyikan semua halaman
            document.querySelectorAll('.member-content-page').forEach(page => {
                page.classList.remove('active');
            });
            // Hilangkan status aktif di sidebar (termasuk yang default di HTML)
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });

            // Tampilkan halaman yang diminta
            const activePage = document.getElementById(pageId);
            if (activePage) {
                activePage.classList.add('active');
            }

            // Tandai link sidebar yang aktif
            const activeLink = document.querySelector(`.sidebar-link[data-page="${pageId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        // --- FUNGSI UNTUK MEMBUKA MODAL DETAIL TRANSAKSI ---
        function openTransactionDetailModal(transactionId) {
            const transaction = userData.transactions.find(tx => tx.id === transactionId);

            if (transaction) {
                document.getElementById('modal-transaction-id').textContent = transaction.id;
                document.getElementById('modal-transaction-date').textContent = transaction.date;
                document.getElementById('modal-transaction-total').textContent = formatRupiah(transaction.total);

                const statusSpan = document.getElementById('modal-transaction-status');
                statusSpan.textContent = transaction.status;
                statusSpan.className = `px-2 py-0.5 text-xs font-semibold rounded-full ${
                    transaction.color === 'yellow' ? 'text-yellow-800 bg-yellow-100' :
                    transaction.color === 'green' ? 'text-green-800 bg-green-100' :
                    'text-red-800 bg-red-100'
                }`;

                const itemsList = document.getElementById('modal-transaction-items');
                itemsList.innerHTML = ''; // Kosongkan daftar item sebelumnya
                if (transaction.items && transaction.items.length > 0) {
                    transaction.items.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = `${item.name} (${item.qty}x) - ${formatRupiah(item.price)}`;
                        itemsList.appendChild(li);
                    });
                } else {
                    itemsList.innerHTML = '<li>Tidak ada detail item.</li>';
                }

                document.getElementById('transaction-detail-modal').classList.remove('hidden');
            }
        }

        // --- FUNGSI UNTUK MENUTUP MODAL DETAIL TRANSAKSI ---
        function closeTransactionDetailModal() {
            document.getElementById('transaction-detail-modal').classList.add('hidden');
        }


        // --- FUNGSI MUAT DATA ---
        function loadMemberData() {
            // 1. DASHBOARD & PROFIL
            const initials = userData.name.split(' ').map(n => n[0]).join('');
            document.getElementById('user-initial').textContent = initials;
            document.getElementById('user-name').textContent = userData.name;
            document.getElementById('dash-points').textContent = userData.points.toLocaleString('id-ID');
            document.getElementById('dash-status').textContent = userData.status;

            // Profil Saya
            document.getElementById('profile-name').textContent = userData.name;
            // Perlu juga update email, phone, address di halaman Profile jika ingin dinamis

            // 2. POIN
            document.getElementById('poin-total').textContent = userData.points.toLocaleString('id-ID');
            const pointValue = userData.points * 100; // Asumsi 1 Poin = Rp 100
            document.getElementById('poin-value-info').textContent = `Setara dengan ${formatRupiah(pointValue)}`;

            // Riwayat Poin
            const pointHistoryList = document.getElementById('poin-history');
            pointHistoryList.innerHTML = '';
            userData.pointHistory.forEach(item => {
                const li = document.createElement('li');
                const sign = item.type === 'Kredit' ? '+' : '-';
                const colorClass = item.type === 'Kredit' ? 'text-green-600' : 'text-red-600';
                li.innerHTML = `
                    <div class="flex justify-between border-b border-gray-100 py-1">
                        <span>${item.date} - ${item.desc}</span>
                        <span class="font-bold ${colorClass}">${sign}${item.amount.toLocaleString('id-ID')} Poin</span>
                    </div>
                `;
                pointHistoryList.appendChild(li);
            });


            // 3. RIWAYAT TRANSAKSI LENGKAP (untuk halaman Orders)
            const transactionTable = document.getElementById('transaction-table');
            transactionTable.innerHTML = ''; // Kosongkan dulu

            userData.transactions.forEach(tx => {
                const row = document.createElement('tr');
                const badgeColorClass = tx.color === 'yellow' ? 'text-yellow-800 bg-yellow-100' :
                                        tx.color === 'green' ? 'text-green-800 bg-green-100' :
                                        'text-red-800 bg-red-100';
                row.className = 'hover:bg-gray-50 cursor-pointer'; // Tambah cursor-pointer
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-[color:var(--kencana-blue)]">${tx.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${tx.date}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700 font-semibold">${formatRupiah(tx.total)}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-3 py-1 text-xs font-semibold rounded-full ${badgeColorClass}">
                            ${tx.status}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button onclick="event.stopPropagation(); openTransactionDetailModal('${tx.id}')"
                                class="text-[color:var(--kencana-blue)] hover:text-blue-800">Detail</button>
                    </td>
                `;
                transactionTable.appendChild(row);

                // Tambahkan event listener untuk membuka modal, saat mengklik ROW (bukan tombol detail)
                // Ini agar seluruh baris bisa diklik, tapi event tombol tidak tertimpa
                row.addEventListener('click', () => openTransactionDetailModal(tx.id));
            });

            // 4. 3 TRANSAKSI TERAKHIR (untuk halaman Dashboard)
            const latestTransactionsList = document.getElementById('latest-transactions-list');
            latestTransactionsList.innerHTML = ''; // Kosongkan dulu

            // Ambil 3 transaksi terakhir (jika ada lebih dari 3)
            // Menggunakan slice(0, 3) untuk mengambil 3 transaksi pertama (terbaru, jika array diurutkan dari terbaru)
            const latestThreeTransactions = userData.transactions.slice(0, 3);

            if (latestThreeTransactions.length > 0) {
                latestThreeTransactions.forEach(tx => {
                    const li = document.createElement('li');
                    const badgeColorClass = tx.color === 'yellow' ? 'text-yellow-800 bg-yellow-100' :
                                            tx.color === 'green' ? 'text-green-800 bg-green-100' :
                                            'text-red-800 bg-red-100';
                    li.className = 'py-3 flex items-center justify-between cursor-pointer'; // Tambah cursor-pointer
                    li.innerHTML = `
                        <div>
                            <p class="text-sm font-semibold text-gray-800">${tx.id} - ${formatRupiah(tx.total)}</p>
                            <p class="text-xs text-gray-500">${tx.date}</p>
                        </div>
                        <span class="px-2 py-0.5 text-xs font-semibold rounded-full ${badgeColorClass}">
                            ${tx.status}
                        </span>
                    `;
                    latestTransactionsList.appendChild(li);

                    // Tambahkan event listener untuk membuka modal
                    li.addEventListener('click', () => openTransactionDetailModal(tx.id));
                });
            } else {
                latestTransactionsList.innerHTML = `<li class="py-2 text-sm text-gray-500 text-center">Belum ada transaksi.</li>`;
            }
        }

        // --- INTI SKRIP ---
        document.addEventListener('DOMContentLoaded', () => {
            loadMemberData();

            // Tentukan halaman default saat pertama kali dimuat
            const initialPage = window.location.hash.substring(1) || 'dashboard'; // Ambil dari hash URL atau default ke dashboard
            switchPage(initialPage);

            // Tambahkan event listener ke setiap link sidebar
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = link.getAttribute('data-page');
                    if (pageId) {
                        switchPage(pageId);
                    }
                });
            });

            // Event listener untuk tombol tutup modal
            document.getElementById('close-modal-btn').addEventListener('click', closeTransactionDetailModal);

            // Event listener untuk menutup modal jika mengklik di luar area modal
            document.getElementById('transaction-detail-modal').addEventListener('click', (e) => {
                if (e.target.id === 'transaction-detail-modal') {
                    closeTransactionDetailModal();
                }
            });
        });
    </script>
</body>

</html>